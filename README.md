# 基于多尺度融合的CNN神经网络
### 任务概述
蛋白质的二级结构是氨基酸序列通过局部氢键相互作用形成的稳定三维构象，主要包括α-螺旋（α-helix）、β-折叠（β-sheet）和无规则卷曲（random coil）。这些结构不仅是蛋白质折叠成特定功能构象的基础，也直接影响其生物活性、稳定性和分子相互作用。传统实验方法（如X射线晶体学和核磁共振）测定二级结构成本高且耗时，因此，计算预测方法在生物信息学中具有重要价值。早期的预测算法（如Chou-Fasman、GOR方法）依赖统计规则，而现代深度学习技术能够直接从序列数据中学习高阶特征，显著提高了预测精度。
![图片](https://github.com/user-attachments/assets/668af4fb-13f5-4625-8ec5-ab666a11ece1)
蛋白质二级结构预测是理解蛋白质折叠与功能的关键环节。当前主流方法多采用RNN或Transformer架构，前者通过循环连接捕捉序列依赖性，后者利用自注意力机制建模长程相互作用。然而，这些方法在计算效率和局部特征提取方面存在局限。
本研究尝试采用卷积神经网络（CNN）作为替代方案。与RNN和Transformer不同，CNN通过局部感受野和权值共享机制，能够更高效地捕捉氨基酸序列中的短程模式，特别是氢键形成倾向等局部特征。我们基于PyTorch实现了一个多尺度CNN架构，使用不同大小的卷积核并行提取多粒度特征。模型采用层次化设计，底层卷积层专注于局部模式识别，高层通过扩张卷积扩大感受野，逐步整合更广泛的序列上下文信息。
### 网络框图及各部分详细说明
#### 输入处理阶段
·网络接收输入数据的维度为(batch, seq_len)，表示批量大小和序列长度
·首先通过Embedding层将21维的离散输入（20种氨基酸+填充符）转换为64维的连续向量表示
·使用Permute操作调整维度顺序为(batch, 64, seq_len)，以适配后续的卷积操作
#### 多尺度特征提取
###### ·Branch3分支：
·先进行3×3的分组卷积（groups=32）提取局部特征
·接着使用1×1卷积增强通道间信息交互
·经过批归一化(BatchNorm)、ReLU激活和Dropout(0.3)正则化
·最后通过自适应平均池化(AdaptiveAvgPool)调整特征维度
###### ·Branch5分支：
·采用5×5空洞卷积（dilation=2）扩大感受野，捕获长程依赖关系
·同样使用1×1卷积进行特征变换
·经过相同的归一化和激活处理
·最后进行自适应池化
#### 特征融合阶段、
·将两个分支的输出特征进行拼接(Concat)
·通过1×1卷积进行特征融合和降维
·使用最大池化(MaxPool1d)下采样，stride=2
·再次应用自适应平均池化确保输出维度一致
#### 分类输出阶段
·使用1×1卷积将特征映射到类别空间（num_classes）
·通过Flatten操作调整输出形状
·最终输出维度为(batch, max_len, num_classes)，表示每个序列位置的类别预测
![图片](https://github.com/user-attachments/assets/f6c90585-968d-419b-bb86-2ec11ccad9fd)
### 环境搭建（建议linux）
1、`apt-get install dssp `
2、`pip3 -r install requirement.txt`
### 使用方法
1、运行GetData.py获取源数据集，并下载到train_data和test_data两个目录下（已经下载好一份）
2、运行ProcessData.py进行预处理，转化成实验数据，得到X.pt和y.pt数据集
3、运行train.ipynb文件，进行训练











